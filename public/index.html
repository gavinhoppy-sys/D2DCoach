<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>D2D Coach</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800;900&display=swap" rel="stylesheet">
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --bg:        #161616;
      --bg2:       #1e1e1e;
      --surface:   rgba(255,255,255,0.04);
      --surface2:  rgba(255,255,255,0.07);
      --border:    rgba(255,255,255,0.08);
      --border2:   rgba(255,255,255,0.14);
      --text:      #f0f0f0;
      --text2:     rgba(255,255,255,0.55);
      --text3:     rgba(255,255,255,0.3);
      --purple:    #8b5cf6;
      --purple2:   #7c3aed;
      --purple-glow: rgba(139,92,246,0.3);
      --green:     #10b981;
      --green2:    #059669;
      --green-glow: rgba(16,185,129,0.3);
    }

    body {
      font-family: 'Inter', system-ui, sans-serif;
      background: var(--bg); color: var(--text);
      min-height: 100vh;
      display: flex; flex-direction: column; align-items: center; justify-content: center;
      padding: 24px 20px;
    }

    /* Subtle background glow */
    body::before {
      content: '';
      position: fixed; inset: 0; pointer-events: none;
      background: radial-gradient(ellipse 60% 50% at 30% 40%, rgba(139,92,246,0.08) 0%, transparent 70%),
                  radial-gradient(ellipse 50% 40% at 70% 65%, rgba(16,185,129,0.06) 0%, transparent 70%);
    }

    /* ‚îÄ‚îÄ Brand ‚îÄ‚îÄ */
    .brand {
      text-align: center; margin-bottom: 48px; position: relative;
    }
    .brand-logo {
      width: 64px; height: 64px; border-radius: 18px; margin: 0 auto 16px;
      background: linear-gradient(135deg, var(--purple2), var(--purple));
      display: flex; align-items: center; justify-content: center; font-size: 30px;
      box-shadow: 0 12px 32px var(--purple-glow);
    }
    .brand h1 {
      font-size: 32px; font-weight: 900; letter-spacing: -1px;
      background: linear-gradient(135deg, #fff 30%, rgba(255,255,255,0.6));
      -webkit-background-clip: text; -webkit-text-fill-color: transparent;
    }
    .brand p {
      font-size: 15px; color: var(--text2); margin-top: 6px; line-height: 1.5;
    }

    /* ‚îÄ‚îÄ Role cards ‚îÄ‚îÄ */
    .cards {
      display: flex; gap: 16px; width: 100%; max-width: 680px;
      flex-wrap: wrap;
    }

    .role-card {
      flex: 1; min-width: 280px;
      background: var(--bg2); border-radius: 22px; padding: 32px 28px;
      border: 1px solid var(--border2);
      box-shadow: 0 16px 48px rgba(0,0,0,0.35);
      display: flex; flex-direction: column; gap: 0;
      position: relative; overflow: hidden;
    }
    .role-card::before {
      content: ''; position: absolute; top: 0; left: 0; right: 0; height: 2px;
    }
    .role-card.rep::before    { background: linear-gradient(90deg, var(--purple2), var(--purple)); }
    .role-card.manager::before { background: linear-gradient(90deg, var(--green2), var(--green)); }

    .card-icon {
      width: 50px; height: 50px; border-radius: 14px; margin-bottom: 18px;
      display: flex; align-items: center; justify-content: center; font-size: 22px;
    }
    .rep    .card-icon { background: rgba(139,92,246,0.15); border: 1px solid rgba(139,92,246,0.25); }
    .manager .card-icon { background: rgba(16,185,129,0.12); border: 1px solid rgba(16,185,129,0.22); }

    .card-title { font-size: 20px; font-weight: 800; letter-spacing: -0.4px; margin-bottom: 6px; }
    .card-desc  { font-size: 13px; color: var(--text2); line-height: 1.55; margin-bottom: 24px; }

    /* Inputs */
    .field-label {
      font-size: 11px; font-weight: 600; text-transform: uppercase;
      letter-spacing: 0.6px; color: var(--text3); margin-bottom: 7px;
    }
    .field-input {
      width: 100%; background: var(--surface); border: 1px solid var(--border2);
      color: var(--text); border-radius: 11px;
      padding: 12px 14px; font-size: 15px; outline: none;
      font-family: inherit; margin-bottom: 12px;
      transition: border-color 0.15s, box-shadow 0.15s;
    }
    .field-input::placeholder { color: var(--text3); }
    .field-input.pin-field { letter-spacing: 4px; font-size: 18px; text-align: center; }

    .rep .field-input:focus {
      border-color: var(--purple);
      box-shadow: 0 0 0 3px rgba(139,92,246,0.15);
    }
    .manager .field-input:focus {
      border-color: var(--green);
      box-shadow: 0 0 0 3px rgba(16,185,129,0.12);
    }
    .field-input.shake {
      animation: shake 0.35s ease;
      border-color: #ef4444;
      box-shadow: 0 0 0 3px rgba(239,68,68,0.12);
    }
    @keyframes shake {
      0%, 100% { transform: translateX(0); }
      20%, 60%  { transform: translateX(-6px); }
      40%, 80%  { transform: translateX(6px); }
    }

    /* Buttons */
    .enter-btn {
      width: 100%; padding: 13px; border-radius: 11px;
      border: none; font-size: 15px; font-weight: 700;
      cursor: pointer; font-family: inherit;
      transition: box-shadow 0.15s, opacity 0.15s;
    }
    .enter-btn:disabled { opacity: 0.5; cursor: not-allowed; }

    .rep .enter-btn {
      background: linear-gradient(135deg, var(--purple2), var(--purple));
      color: white;
      box-shadow: 0 4px 16px var(--purple-glow);
    }
    .rep .enter-btn:hover:not(:disabled) { box-shadow: 0 6px 22px rgba(139,92,246,0.5); }

    .manager .enter-btn {
      background: linear-gradient(135deg, var(--green2), var(--green));
      color: white;
      box-shadow: 0 4px 16px var(--green-glow);
    }
    .manager .enter-btn:hover:not(:disabled) { box-shadow: 0 6px 22px rgba(16,185,129,0.4); }

    .field-error {
      font-size: 12px; color: #f87171; margin-top: -6px;
      margin-bottom: 10px; min-height: 16px;
    }

    /* Footer */
    .footer {
      margin-top: 36px; font-size: 12px; color: var(--text3); text-align: center;
    }
  </style>
</head>
<body>

  <div class="brand">
    <div class="brand-logo">üè†</div>
    <h1>D2D Coach</h1>
    <p>AI-powered door-to-door sales training</p>
  </div>

  <div class="cards">

    <!-- Rep card -->
    <div class="role-card rep">
      <div class="card-icon">üßë‚Äçüíº</div>
      <div class="card-title">Sales Rep</div>
      <div class="card-desc">Practice your pitch against an AI homeowner, get live coaching, and track your progress over time.</div>
      <div class="field-label">Your name</div>
      <input class="field-input" id="repName" type="text" placeholder="First name" maxlength="40"
        onkeydown="if(event.key==='Enter') enterAsRep()">
      <button class="enter-btn" onclick="enterAsRep()">Enter as Rep ‚Üí</button>
    </div>

    <!-- Manager card -->
    <div class="role-card manager">
      <div class="card-icon">üìä</div>
      <div class="card-title">Sales Manager</div>
      <div class="card-desc">View your team's performance, track rep progress, and identify areas for improvement across all sessions.</div>
      <div class="field-label">Manager PIN</div>
      <input class="field-input pin-field" id="managerPin" type="password" placeholder="‚Ä¢‚Ä¢‚Ä¢‚Ä¢" maxlength="20"
        onkeydown="if(event.key==='Enter') enterAsManager()">
      <div class="field-error" id="pinError"></div>
      <button class="enter-btn" id="managerBtn" onclick="enterAsManager()">Enter as Manager ‚Üí</button>
    </div>

  </div>

  <div class="footer">D2D Coach &mdash; Roofing Sales Training</div>

<script>
  function enterAsRep() {
    const name = document.getElementById('repName').value.trim();
    if (!name) {
      const inp = document.getElementById('repName');
      inp.focus();
      inp.classList.remove('shake');
      void inp.offsetWidth;
      inp.classList.add('shake');
      setTimeout(() => inp.classList.remove('shake'), 400);
      return;
    }
    localStorage.setItem('d2d_rep_name', name);
    window.location.href = '/hub.html';
  }

  async function enterAsManager() {
    const pin = document.getElementById('managerPin').value.trim();
    const errEl = document.getElementById('pinError');
    const btn   = document.getElementById('managerBtn');
    if (!pin) {
      shakePin();
      return;
    }
    errEl.textContent = '';
    btn.disabled = true;
    btn.textContent = 'Checking‚Ä¶';
    try {
      const res = await fetch('/manager/reps?pin=' + encodeURIComponent(pin));
      if (res.status === 401) {
        shakePin();
        errEl.textContent = 'Incorrect PIN.';
      } else {
        sessionStorage.setItem('mgr_pin', pin);
        window.location.href = '/manager.html';
      }
    } catch (_) {
      errEl.textContent = 'Connection error. Try again.';
    } finally {
      btn.disabled = false;
      btn.textContent = 'Enter as Manager ‚Üí';
    }
  }

  function shakePin() {
    const inp = document.getElementById('managerPin');
    inp.classList.remove('shake');
    void inp.offsetWidth;
    inp.classList.add('shake');
    setTimeout(() => inp.classList.remove('shake'), 400);
    inp.value = '';
    inp.focus();
  }
</script>
</body>
</html>
